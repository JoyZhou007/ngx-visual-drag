{"version":3,"sources":["../../projects/ngx-visual-drag/src/lib/ngx-visual-drag.service.ts","../projects/ngx-visual-drag/src/lib/utils/generateID.ts","../projects/ngx-visual-drag/src/lib/utils/utils.ts","../esm2015/projects/ngx-visual-drag/src/lib/core/component/component-data.service.ts","../../projects/ngx-visual-drag/src/lib/ngx-visual-drag.component.ts","../esm2015/projects/ngx-visual-drag/src/lib/core/custom-component/component-list.ts","../esm2015/projects/ngx-visual-drag/src/lib/pages/home/home.component.ts","../esm2015/projects/ngx-visual-drag/src/lib/pages/toolbar/toolbar.component.ts","../../../node_modules/tslib/tslib.es6.js","../esm2015/projects/ngx-visual-drag/src/lib/shared/shared/shared.module.ts","../esm2015/projects/ngx-visual-drag/src/lib/pages/component-list/component-list.component.ts","../projects/ngx-visual-drag/src/lib/utils/style.ts","../esm2015/projects/ngx-visual-drag/src/lib/pages/editor/editor.component.ts","../projects/ngx-visual-drag/src/lib/utils/translate.ts","../projects/ngx-visual-drag/src/lib/utils/calculateComponentPositonAndSize.ts","../esm2015/lib/projects/ngx-visual-drag/src/lib/pages/editor/shape/shape.component.ts","../esm2015/lib/projects/ngx-visual-drag/src/lib/pages/custom-component/v-button/v-button.component.ts","../esm2015/lib/projects/ngx-visual-drag/src/lib/pages/editor/context-menu/context-menu.component.ts","../esm2015/lib/projects/ngx-visual-drag/src/lib/pages/editor/markline/markline.component.ts","../esm2015/projects/ngx-visual-drag/src/lib/pages/attr-list/attr-list.component.ts","../esm2015/lib/projects/ngx-visual-drag/src/lib/pages/editor/preview/preview.component.ts","../esm2015/lib/projects/ngx-visual-drag/src/lib/pages/editor/component-wrapper/component-wrapper.component.ts","../../projects/ngx-visual-drag/src/lib/ngx-visual-drag.module.ts"],"names":["Injectable","args","providedIn","id","generateID","deepCopy","target","result","Array","isArray","key","swap","arr","i","j","temp","ComponentDataService","message","_this","this","componentData","canvasStyleData","width","height","$shapeStyle","Subject","contextmenu","show","top","left","snapshotData","snapshotIndex","notification","$storageData","initData","subscribe","x","curComponent","style","rotate","prototype","deleteCurComponent","splice","curComponentIndex","hideContextMenu","upComponent","length","warning","downComponent","topComponent","bottomComponent","recordSnapshot","slice","undo","redo","setShapePosStyle","_a","value","copy","copyData","data","index","paste","isMouse","addComponent","component","undefined","push","cut","clearCanvas","restore","resetID","canvasData","canvasStyle","localStorage","getItem","JSON","parse","save","setItem","stringify","success","next","forEach","item","setEditMode","type","editMode","NzMessageService","NgxVisualDragComponent","componentDataService","onDataSave","EventEmitter","ngOnInit","emit","Component","selector","template","encapsulation","ViewEncapsulation","None","Input","Output","commonStyle","opacity","list","label","propValue","icon","animations","events","fontSize","fontWeight","lineHeight","letterSpacing","textAlign","color","borderWidth","borderColor","borderRadius","backgroundColor","Object","assign","HomeComponent","handleDrop","e","preventDefault","stopPropagation","componentList","dataTransfer","getData","offsetY","offsetX","handleDragOver","dropEffect","deselectCurComponent","ToolbarComponent","isShowPreview","preview","closePreview","create","__read","o","n","m","Symbol","iterator","r","call","ar","done","error","__spread","arguments","concat","NzButtonModule","NzInputModule","NzMessageModule","NzLayoutModule","NzTabsModule","NzSelectModule","common","CommonModule","FormsModule","NgModule","declarations","imports","exports","ComponentListComponent","handleDragStart","setData","dataset","getStyle","filter","needUnit","keys","includes","EditorComponent","isEdit","handleContextMenu","className","offsetLeft","offsetTop","parentNode","getComponentStyle","angleToRadian","angle","Math","PI","calculateRotatedPointCoordinate","point","center","cos","y","sin","getCenterPoint","p1","p2","abs","funcs","lt","curPositon","pointInfo","symmetricPoint","newCenterPoint","newTopLeftPoint","newBottomRightPoint","newWidth","newHeight","round","t","curPoint","rotatedcurPositon","rotatedTopMiddlePoint","sqrt","pow","newCenter","rt","newTopRightPoint","newBottomLeftPoint","rotatedRightMiddlePoint","rb","b","rotatedBottomMiddlePoint","lb","l","rotatedLeftMiddlePoint","ShapeComponent","active","cursors","pointList","initialAngle","angleToCursor","start","end","cursor","getShapeStyle","handleMouseDownOnShape","element","getCursor","pos","defaultStyle","startY","clientY","startX","clientX","startTop","Number","startLeft","hasMove","move","moveEvent","curX","curY","event","up","document","removeEventListener","addEventListener","selectCurComponent","handleRotate","handleMouseDownOnPoint","downEvent","window","editorRectInfo","querySelector","getBoundingClientRect","needSave","isFirst","name","calculateComponentPositonAndSize","getPointStyle","hasT","test","hasB","hasL","hasR","newLeft","newTop","floor","marginLeft","marginTop","lastMatchIndex","len","angleLimit","VButtonComponent","vStyle","absoulte","ContextMenuComponent","defineProperty","deleteComponent","MarklineComponent","lines","diff","lineStatus","xt","xc","xb","yl","yc","yr","ngAfterContentInit","showLine","hideLine","isDownward","isRightward","from","querySelectorAll","findnode","find","components","curComponentStyle","translateComponentStyle","curComponentHalfwidth","curComponentHalfHeight","componentStyle","bottom","right","componentHalfwidth","componentHalfHeight","conditions","isNearly","lineNode","line","dragShift","lineShift","needToShow","condition","translatecurComponentShift","chooseTheTureLine","diffX","diffY","dragValue","targetValue","ViewChildren","AttrListComponent","map","excludes","options","PreviewComponent","OutClose","close","ComponentWrapperComponent","componentFactoryResolver","ngOnChanges","changes","config","currentValue","handleClick","ComponentFactoryResolver","ViewChild","read","ViewContainerRef","static","BrowserAnimationsModule","SharedModule"],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class NgxVisualDragService {\n\n  constructor() { }\n}\n","let id = 0;\r\n// ä¸ºæ¯ä¸ªåç´ åå»ºä¸ä¸ªç¬ä¸æ äºç ID\r\nexport default function generateID() {\r\n  return id++;\r\n}\r\n","export function deepCopy(target) {\r\n  if (typeof target == 'object') {\r\n    const result = Array.isArray(target) ? [] : {};\r\n    for (const key in target) {\r\n      if (typeof target[key] == 'object') {\r\n        result[key] = deepCopy(target[key]);\r\n      } else {\r\n        result[key] = target[key];\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  return target;\r\n}\r\n\r\nexport function swap(arr, i, j) {\r\n  const temp = arr[i];\r\n  arr[i] = arr[j];\r\n  arr[j] = temp;\r\n}\r\n","import { Injectable } from '@angular/core';\nimport { NzMessageService } from 'ng-zorro-antd/message';\nimport { Subject } from 'rxjs';\nimport {\n  CanvasStyleData,\n  ComponentBaseStyle,\n  ComponentBaseData,\n  CopyData,\n  EditModeType,\n  StorageData,\n} from '../../types/component-type';\nimport generateID from '../../utils/generateID';\nimport { deepCopy, swap } from '../../utils/utils';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ComponentDataService {\n  componentData: ComponentBaseData[] = []; // ç»å¸ç»ä»¶æ°æ®\n  canvasStyleData: CanvasStyleData = {\n    width: 1200,\n    height: 740,\n  }; // é¡µé¢å¨å±æ°æ®\n  curComponent: ComponentBaseData;\n  curComponentIndex: number;\n  $shapeStyle: Subject<ComponentBaseStyle> = new Subject();\n  contextmenu: {\n    show: boolean;\n    top: number;\n    left: number;\n  } = {\n    show: false,\n    top: 0,\n    left: 0,\n  }; // å³å»èåæ°æ®\n  snapshotData: Array<ComponentBaseData[]> = []; // ç¼è¾å¨å¿«ç§æ°æ®\n  snapshotIndex: number = -1; // å¿«ç§ç´¢å¼\n  notification: Subject<{\n    event: string;\n    value?: any;\n  }> = new Subject();\n  copyData: CopyData;\n  editMode: EditModeType;\n  $storageData = new Subject<StorageData>();\n  constructor(private message: NzMessageService) {\n    this.initData();\n    this.$shapeStyle.subscribe((x) => {\n      if (x.top) this.curComponent.style.top = x.top;\n      if (x.left) this.curComponent.style.left = x.left;\n      if (x.width) this.curComponent.style.width = x.width;\n      if (x.height) this.curComponent.style.height = x.height;\n      if (x.rotate) this.curComponent.style.rotate = x.rotate;\n    });\n  }\n\n  initData() {}\n\n  deleteCurComponent() {\n    this.componentData.splice(this.curComponentIndex, 1);\n  }\n\n  hideContextMenu() {\n    this.contextmenu = {\n      show: false,\n      top: 0,\n      left: 0,\n    };\n  }\n\n  upComponent() {\n    // ä¸ç§»å¾å± indexï¼è¡¨ç¤ºåç´ å¨æ°ç»ä¸­è¶å¾å\n    if (this.curComponentIndex < this.componentData.length - 1) {\n      swap(\n        this.componentData,\n        this.curComponentIndex,\n        this.curComponentIndex + 1\n      );\n    } else {\n      this.message.warning('å·²ç»å°é¡¶äº');\n    }\n  }\n\n  downComponent() {\n    // ä¸ç§»å¾å± indexï¼è¡¨ç¤ºåç´ å¨æ°ç»ä¸­è¶å¾å\n    if (this.curComponentIndex > 0) {\n      swap(\n        this.componentData,\n        this.curComponentIndex,\n        this.curComponentIndex - 1\n      );\n    } else {\n      this.message.warning('å·²ç»å°åºäº');\n    }\n  }\n\n  topComponent() {\n    // ç½®é¡¶\n    if (this.curComponentIndex < this.componentData.length - 1) {\n      swap(\n        this.componentData,\n        this.curComponentIndex,\n        this.componentData.length - 1\n      );\n    } else {\n      this.message.warning('å·²ç»å°é¡¶äº');\n    }\n  }\n\n  bottomComponent() {\n    // ç½®åº\n    if (this.curComponentIndex > 0) {\n      swap(this.componentData, this.curComponentIndex, 0);\n    } else {\n      this.message.warning('å·²ç»å°åºäº');\n    }\n  }\n\n  recordSnapshot() {\n    // æ·»å æ°çå¿«ç§\n    this.snapshotData[++this.snapshotIndex] = deepCopy(this.componentData);\n    // å¨ undo è¿ç¨ä¸­ï¼æ·»å æ°çå¿«ç§æ¶ï¼è¦å°å®åé¢çå¿«ç§æ¸çæ\n    if (this.snapshotIndex < this.snapshotData.length - 1) {\n      this.snapshotData = this.snapshotData.slice(0, this.snapshotIndex + 1);\n    }\n  }\n\n  undo() {\n    if (this.snapshotIndex >= 0) {\n      this.snapshotIndex--;\n      this.componentData =\n        deepCopy(this.snapshotData[this.snapshotIndex]) || [];\n    }\n  }\n\n  redo() {\n    if (this.snapshotIndex < this.snapshotData.length - 1) {\n      this.snapshotIndex++;\n      this.componentData =\n        deepCopy(this.snapshotData[this.snapshotIndex]) || [];\n    }\n  }\n\n  setShapePosStyle({ key, value }) {\n    this.curComponent.style[key] = value;\n  }\n\n  copy() {\n    this.copyData = {\n      data: deepCopy(this.curComponent),\n      index: this.curComponentIndex,\n    };\n  }\n\n  paste(isMouse) {\n    if (!this.copyData) {\n      this.message.warning('è¯·éæ©ç»ä»¶');\n      return;\n    }\n\n    const data = this.copyData.data;\n\n    if (isMouse) {\n      data.style.top = this.contextmenu.top;\n      data.style.left = this.contextmenu.left;\n    } else {\n      data.style.top += 10;\n      data.style.left += 10;\n    }\n\n    data.id = generateID();\n    this.addComponent(data);\n    this.recordSnapshot();\n    this.copyData = null;\n  }\n\n  addComponent(component: ComponentBaseData, index?: number) {\n    if (index !== undefined) {\n      this.componentData.splice(index, 0, component);\n    } else {\n      this.componentData.push(component);\n    }\n  }\n\n  cut() {\n    if (!this.curComponent) {\n      this.message.warning('è¯·éæ©ç»ä»¶');\n      return;\n    }\n\n    if (this.copyData) {\n      this.addComponent(this.copyData.data, this.copyData.index);\n      if (this.curComponentIndex >= this.copyData.index) {\n        // å¦æå½åç»ä»¶ç´¢å¼å¤§äºç­äºæå¥ç´¢å¼ï¼éè¦å ä¸ï¼å ä¸ºå½åç»ä»¶å¾åç§»äºä¸ä½\n        this.curComponentIndex++;\n      }\n    }\n    this.copy();\n    this.deleteCurComponent();\n  }\n\n  clearCanvas() {\n    this.componentData = [];\n  }\n\n  restore(data?: StorageData) {\n    // ç¨ä¿å­çæ°æ®æ¢å¤ç»å¸\n    if (data) {\n      this.componentData = this.resetID(data.canvasData);\n      this.canvasStyleData = data.canvasStyle;\n    } else {\n      if (localStorage.getItem('canvasData')) {\n        this.componentData = this.resetID(\n          JSON.parse(localStorage.getItem('canvasData'))\n        );\n      }\n\n      if (localStorage.getItem('canvasStyle')) {\n        this.canvasStyleData = JSON.parse(localStorage.getItem('canvasStyle'));\n      }\n    }\n  }\n\n  save() {\n    localStorage.setItem('canvasData', JSON.stringify(this.componentData));\n    localStorage.setItem('canvasStyle', JSON.stringify(this.canvasStyleData));\n    this.message.success('ä¿å­æå');\n    this.$storageData.next({\n      canvasData: this.componentData,\n      canvasStyle: this.canvasStyleData,\n    });\n  }\n\n  resetID(data) {\n    data.forEach((item) => {\n      item.id = generateID();\n    });\n\n    return data;\n  }\n\n  setEditMode(type: EditModeType) {\n    this.editMode = type;\n  }\n}\n","import {\n  Component,\n  EventEmitter,\n  Input,\n  OnInit,\n  Output,\n  ViewEncapsulation,\n} from '@angular/core';\nimport { ComponentDataService } from './core/component/component-data.service';\nimport { StorageData } from './types/component-type';\n\n@Component({\n  selector: 'lib-ngx-visual-drag',\n  template: ` <lib-home [data]=\"data\"></lib-home> `,\n  styleUrls: ['./index.scss'],\n  encapsulation: ViewEncapsulation.None,\n})\nexport class NgxVisualDragComponent implements OnInit {\n  @Input() data: StorageData;\n  @Output() onDataSave = new EventEmitter<StorageData>();\n  constructor(private componentDataService: ComponentDataService) {}\n\n  ngOnInit(): void {\n    this.componentDataService.$storageData.subscribe((x) => {\n      this.onDataSave.emit(x);\n    });\n  }\n}\n","// å¬å±æ ·å¼\r\nconst commonStyle = {\r\n  rotate: '',\r\n  opacity: 1,\r\n};\r\n\r\n// ç¼è¾å¨å·¦ä¾§ç»ä»¶åè¡¨\r\nconst list = [\r\n  {\r\n    component: 'v-text',\r\n    label: 'æå­',\r\n    propValue: 'æå­',\r\n    icon: 'el-icon-edit',\r\n    animations: [],\r\n    events: {},\r\n    style: {\r\n      width: 200,\r\n      height: 33,\r\n      fontSize: 14,\r\n      fontWeight: 500,\r\n      lineHeight: '',\r\n      letterSpacing: 0,\r\n      textAlign: '',\r\n      color: '',\r\n    },\r\n  },\r\n  {\r\n    component: 'v-button',\r\n    label: 'æé®',\r\n    propValue: 'æé®',\r\n    icon: 'el-icon-thumb',\r\n    animations: [],\r\n    events: {},\r\n    style: {\r\n      width: 100,\r\n      height: 34,\r\n      borderWidth: '',\r\n      borderColor: '',\r\n      borderRadius: '',\r\n      fontSize: 14,\r\n      fontWeight: 500,\r\n      lineHeight: '',\r\n      letterSpacing: 0,\r\n      textAlign: '',\r\n      color: '',\r\n      backgroundColor: '',\r\n    },\r\n  },\r\n  {\r\n    component: 'Picture',\r\n    label: 'å¾ç',\r\n    icon: 'el-icon-picture',\r\n    propValue: './../../assets/title.jpg',\r\n    animations: [],\r\n    events: {},\r\n    style: {\r\n      width: 300,\r\n      height: 200,\r\n      borderRadius: '',\r\n    },\r\n  },\r\n];\r\n\r\nlist.forEach((item) => {\r\n  item.style = { ...item.style, ...commonStyle };\r\n});\r\n\r\nexport default list;\r\n","import { Component, Input, OnInit, ViewEncapsulation } from '@angular/core';\nimport { ComponentDataService } from '../../core/component/component-data.service';\nimport componentList from '../../core/custom-component/component-list';\nimport { StorageData } from '../../types/component-type';\nimport generateID from '../../utils/generateID';\nimport { deepCopy } from '../../utils/utils';\n\n@Component({\n  selector: 'lib-home',\n  templateUrl: './home.component.html',\n  styleUrls: ['./home.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n})\nexport class HomeComponent implements OnInit {\n  @Input() data: StorageData;\n  constructor(public componentDataService: ComponentDataService) {}\n\n  ngOnInit(): void {\n    this.componentDataService.restore(this.data);\n  }\n\n  handleDrop(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    const component = deepCopy(componentList[e.dataTransfer.getData('index')]);\n    component.style.top = e.offsetY;\n    component.style.left = e.offsetX;\n    component.id = generateID();\n    this.componentDataService.componentData.push(component);\n    this.componentDataService.recordSnapshot();\n  }\n\n  handleDragOver(e) {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'copy';\n  }\n\n  deselectCurComponent() {\n    this.componentDataService.curComponent = null;\n    this.componentDataService.curComponentIndex = null;\n    this.componentDataService.hideContextMenu();\n  }\n}\n","import { Component, OnInit, ViewEncapsulation } from '@angular/core';\nimport { NzMessageService } from 'ng-zorro-antd/message';\nimport { ComponentDataService } from '../../core/component/component-data.service';\n\n@Component({\n  selector: 'toolbar',\n  templateUrl: './toolbar.component.html',\n  styleUrls: ['./toolbar.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n})\nexport class ToolbarComponent implements OnInit {\n  isShowPreview: boolean = false;\n  constructor(\n    public componentDataService: ComponentDataService,\n    private message: NzMessageService\n  ) {}\n\n  ngOnInit(): void {}\n\n  redo() {\n    this.componentDataService.redo();\n  }\n\n  undo() {\n    this.componentDataService.undo();\n  }\n\n  save() {\n    this.componentDataService.save();\n  }\n\n  clearCanvas() {\n    this.componentDataService.clearCanvas();\n  }\n\n  preview() {\n    this.isShowPreview = true;\n    this.componentDataService.setEditMode('read');\n  }\n\n  closePreview() {\n    this.isShowPreview = false;\n  }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NzButtonModule } from 'ng-zorro-antd/button';\nimport { NzInputModule } from 'ng-zorro-antd/input';\nimport { FormsModule } from '@angular/forms';\nimport { NzMessageModule } from 'ng-zorro-antd/message';\nimport { NzLayoutModule } from 'ng-zorro-antd/layout';\nimport { NzTabsModule } from 'ng-zorro-antd/tabs';\nimport { NzSelectModule } from 'ng-zorro-antd/select';\n\n//#region\nconst list = [\n  NzButtonModule,\n  NzInputModule,\n  NzMessageModule,\n  NzLayoutModule,\n  NzTabsModule,\n  NzSelectModule,\n];\n//#endregion\n\n//#region\nconst common = [CommonModule, FormsModule];\n//#endregion\n\n@NgModule({\n  declarations: [],\n  imports: [...common, ...list],\n  exports: [common, ...list],\n})\nexport class SharedModule {}\n","import { Component, OnInit } from '@angular/core';\nimport list from './../../core/custom-component/component-list';\n\n@Component({\n  selector: 'component-list',\n  templateUrl: './component-list.component.html',\n  styleUrls: ['./component-list.component.scss']\n})\nexport class ComponentListComponent implements OnInit {\n  componentList = list;\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n  handleDragStart(e) {\n    e.dataTransfer.setData('index', e.target.dataset.index);\n  }\n\n}\n\n\n","export default function getStyle(style, filter = []) {\r\n  const needUnit = [\r\n    'fontSize',\r\n    'width',\r\n    'height',\r\n    'top',\r\n    'left',\r\n    'borderWidth',\r\n    'borderRadius',\r\n  ];\r\n\r\n  const result = {};\r\n  Object.keys(style).forEach((key) => {\r\n    if (!filter.includes(key)) {\r\n      if (key != 'rotate') {\r\n        result[key] = style[key];\r\n\r\n        if (needUnit.includes(key)) {\r\n          result[key] += 'px';\r\n        }\r\n      } else {\r\n        result['transform'] = key + '(' + style[key] + 'deg)';\r\n      }\r\n    }\r\n  });\r\n\r\n  return result;\r\n}\r\n","import { Component, OnInit, ViewEncapsulation } from '@angular/core';\nimport { ComponentDataService } from '../../core/component/component-data.service';\nimport { ComponentBaseStyle } from '../../types/component-type';\nimport getStyle from '../../utils/style';\n\n@Component({\n  selector: 'editor',\n  templateUrl: './editor.component.html',\n  styleUrls: ['./editor.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n})\nexport class EditorComponent implements OnInit {\n  isEdit: boolean = false;\n  constructor(public componentDataService: ComponentDataService) {}\n\n  ngOnInit(): void {}\n\n  handleContextMenu(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    // è®¡ç®èåç¸å¯¹äºç¼è¾å¨çä½ç§»\n    let target = e.target;\n    let top = e.offsetY;\n    let left = e.offsetX;\n    while (!target.className.includes('editor')) {\n      left += target.offsetLeft;\n      top += target.offsetTop;\n      target = target.parentNode;\n    }\n    this.componentDataService.contextmenu = {\n      show: true,\n      top,\n      left,\n    };\n  }\n\n  getComponentStyle(style: ComponentBaseStyle) {\n    return getStyle(style, ['top', 'left', 'width', 'height', 'rotate']);\n  }\n}\n","// è§åº¦è½¬å¼§åº¦\r\n// Math.PI = 180 åº¦\r\nfunction angleToRadian(angle) {\r\n    return angle * Math.PI / 180\r\n}\r\n\r\n/**\r\n * è®¡ç®æ ¹æ®åå¿æè½¬åçç¹çåæ \r\n * @param   {Object}  point  æè½¬åçç¹åæ \r\n * @param   {Object}  center æè½¬ä¸­å¿\r\n * @param   {Number}  rotate æè½¬çè§åº¦\r\n * @return  {Object}         æè½¬åçåæ \r\n * https://www.zhihu.com/question/67425734/answer/252724399 æè½¬ç©éµå¬å¼\r\n */\r\nexport function calculateRotatedPointCoordinate(point, center, rotate) {\r\n    /**\r\n     * æè½¬å¬å¼ï¼\r\n     *  ç¹a(x, y)\r\n     *  æè½¬ä¸­å¿c(x, y)\r\n     *  æè½¬åç¹n(x, y)\r\n     *  æè½¬è§åº¦Î¸                tan ??\r\n     * nx = cosÎ¸ * (ax - cx) - sinÎ¸ * (ay - cy) + cx\r\n     * ny = sinÎ¸ * (ax - cx) + cosÎ¸ * (ay - cy) + cy\r\n     */\r\n\r\n    return {\r\n        x: (point.x - center.x) * Math.cos(angleToRadian(rotate)) - (point.y - center.y) * Math.sin(angleToRadian(rotate)) + center.x,\r\n        y: (point.x - center.x) * Math.sin(angleToRadian(rotate)) + (point.y - center.y) * Math.cos(angleToRadian(rotate)) + center.y,\r\n    }\r\n}\r\n\r\n/**\r\n * è·åæè½¬åçç¹åæ ï¼å«ä¸ªç¹ä¹ä¸ï¼\r\n * @param  {Object} style  æ ·å¼\r\n * @param  {Object} center ç»ä»¶ä¸­å¿ç¹\r\n * @param  {String} name   ç¹åç§°\r\n * @return {Object}        æè½¬åçç¹åæ \r\n */\r\nexport function getRotatedPointCoordinate(style, center, name) {\r\n    let point // point æ¯æªæè½¬åçåæ \r\n    switch (name) {\r\n        case 't':\r\n            point = {\r\n                x: style.left + (style.width / 2),\r\n                y: style.top,\r\n            }\r\n\r\n            break\r\n        case 'b':\r\n            point = {\r\n                x: style.left + (style.width / 2),\r\n                y: style.top + style.height,\r\n            }\r\n\r\n            break\r\n        case 'l':\r\n            point = {\r\n                x: style.left,\r\n                y: style.top + style.height / 2,\r\n            }\r\n\r\n            break\r\n        case 'r':\r\n            point = {\r\n                x: style.left + style.width,\r\n                y: style.top + style.height / 2,\r\n            }\r\n\r\n            break\r\n        case 'lt':\r\n            point = {\r\n                x: style.left,\r\n                y: style.top,\r\n            }\r\n\r\n            break\r\n        case 'rt':\r\n            point = {\r\n                x: style.left + style.width,\r\n                y: style.top,\r\n            }\r\n\r\n            break\r\n        case 'lb':\r\n            point = {\r\n                x: style.left,\r\n                y: style.top + style.height,\r\n            }\r\n\r\n            break\r\n        default: // rb\r\n            point = {\r\n                x: style.left + style.width,\r\n                y: style.top+ style.height,\r\n            }\r\n            \r\n            break\r\n    }\r\n\r\n    return calculateRotatedPointCoordinate(point, center, style.rotate)\r\n}\r\n\r\n// æ±ä¸¤ç¹ä¹é´çä¸­ç¹åæ \r\nexport function getCenterPoint(p1, p2) {\r\n    return {\r\n        x: p1.x + ((p2.x - p1.x) / 2),\r\n        y: p1.y + ((p2.y - p1.y) / 2),\r\n    }\r\n}\r\n\r\nexport function sin(rotate) {\r\n    return Math.abs(Math.sin(angleToRadian(rotate)))\r\n}\r\n  \r\nexport function cos(rotate) {\r\n    return Math.abs(Math.cos(angleToRadian(rotate)))\r\n}","import { calculateRotatedPointCoordinate, getCenterPoint } from './translate';\r\n\r\nconst funcs = {\r\n  lt: calculateLeftTop,\r\n  t: calculateTop,\r\n  rt: calculateRightTop,\r\n  r: calculateRight,\r\n  rb: calculateRightBottom,\r\n  b: calculateBottom,\r\n  lb: calculateLeftBottom,\r\n  l: calculateLeft,\r\n};\r\n\r\nfunction calculateLeftTop(style, curPositon, pointInfo) {\r\n  const { symmetricPoint } = pointInfo;\r\n  const newCenterPoint = getCenterPoint(curPositon, symmetricPoint);\r\n  const newTopLeftPoint = calculateRotatedPointCoordinate(\r\n    curPositon,\r\n    newCenterPoint,\r\n    -style.rotate\r\n  );\r\n  const newBottomRightPoint = calculateRotatedPointCoordinate(\r\n    symmetricPoint,\r\n    newCenterPoint,\r\n    -style.rotate\r\n  );\r\n\r\n  const newWidth = newBottomRightPoint.x - newTopLeftPoint.x;\r\n  const newHeight = newBottomRightPoint.y - newTopLeftPoint.y;\r\n  if (newWidth > 0 && newHeight > 0) {\r\n    style.width = Math.round(newWidth);\r\n    style.height = Math.round(newHeight);\r\n    style.left = Math.round(newTopLeftPoint.x);\r\n    style.top = Math.round(newTopLeftPoint.y);\r\n  }\r\n}\r\n\r\nfunction calculateTop(style, curPositon, pointInfo) {\r\n  const { symmetricPoint, curPoint } = pointInfo;\r\n  const rotatedcurPositon = calculateRotatedPointCoordinate(\r\n    curPositon,\r\n    curPoint,\r\n    -style.rotate\r\n  );\r\n  const rotatedTopMiddlePoint = calculateRotatedPointCoordinate(\r\n    {\r\n      x: curPoint.x,\r\n      y: rotatedcurPositon.y,\r\n    },\r\n    curPoint,\r\n    style.rotate\r\n  );\r\n\r\n  // å¾è¡å®ç\r\n  const newHeight = Math.sqrt(\r\n    (rotatedTopMiddlePoint.x - symmetricPoint.x) ** 2 +\r\n      (rotatedTopMiddlePoint.y - symmetricPoint.y) ** 2\r\n  );\r\n\r\n  if (newHeight > 0) {\r\n    const newCenter = {\r\n      x:\r\n        rotatedTopMiddlePoint.x -\r\n        (rotatedTopMiddlePoint.x - symmetricPoint.x) / 2,\r\n      y:\r\n        rotatedTopMiddlePoint.y +\r\n        (symmetricPoint.y - rotatedTopMiddlePoint.y) / 2,\r\n    };\r\n\r\n    style.height = Math.round(newHeight);\r\n    style.top = Math.round(newCenter.y - newHeight / 2);\r\n    style.left = Math.round(newCenter.x - style.width / 2);\r\n  }\r\n}\r\n\r\nfunction calculateRight(style, curPositon, pointInfo) {\r\n  const { symmetricPoint, curPoint } = pointInfo;\r\n  const rotatedcurPositon = calculateRotatedPointCoordinate(\r\n    curPositon,\r\n    curPoint,\r\n    -style.rotate\r\n  );\r\n  const rotatedRightMiddlePoint = calculateRotatedPointCoordinate(\r\n    {\r\n      x: rotatedcurPositon.x,\r\n      y: curPoint.y,\r\n    },\r\n    curPoint,\r\n    style.rotate\r\n  );\r\n\r\n  const newWidth = Math.sqrt(\r\n    (rotatedRightMiddlePoint.x - symmetricPoint.x) ** 2 +\r\n      (rotatedRightMiddlePoint.y - symmetricPoint.y) ** 2\r\n  );\r\n  if (newWidth > 0) {\r\n    const newCenter = {\r\n      x:\r\n        rotatedRightMiddlePoint.x -\r\n        (rotatedRightMiddlePoint.x - symmetricPoint.x) / 2,\r\n      y:\r\n        rotatedRightMiddlePoint.y +\r\n        (symmetricPoint.y - rotatedRightMiddlePoint.y) / 2,\r\n    };\r\n\r\n    style.width = Math.round(newWidth);\r\n    style.top = Math.round(newCenter.y - style.height / 2);\r\n    style.left = Math.round(newCenter.x - newWidth / 2);\r\n  }\r\n}\r\n\r\nfunction calculateBottom(style, curPositon, pointInfo) {\r\n  const { symmetricPoint, curPoint } = pointInfo;\r\n  const rotatedcurPositon = calculateRotatedPointCoordinate(\r\n    curPositon,\r\n    curPoint,\r\n    -style.rotate\r\n  );\r\n  const rotatedBottomMiddlePoint = calculateRotatedPointCoordinate(\r\n    {\r\n      x: curPoint.x,\r\n      y: rotatedcurPositon.y,\r\n    },\r\n    curPoint,\r\n    style.rotate\r\n  );\r\n\r\n  const newHeight = Math.sqrt(\r\n    (rotatedBottomMiddlePoint.x - symmetricPoint.x) ** 2 +\r\n      (rotatedBottomMiddlePoint.y - symmetricPoint.y) ** 2\r\n  );\r\n  if (newHeight > 0) {\r\n    const newCenter = {\r\n      x:\r\n        rotatedBottomMiddlePoint.x -\r\n        (rotatedBottomMiddlePoint.x - symmetricPoint.x) / 2,\r\n      y:\r\n        rotatedBottomMiddlePoint.y +\r\n        (symmetricPoint.y - rotatedBottomMiddlePoint.y) / 2,\r\n    };\r\n    style.height = Math.round(newHeight);\r\n    style.top = Math.round(newCenter.y - newHeight / 2);\r\n    style.left = Math.round(newCenter.x - style.width / 2);\r\n  }\r\n}\r\n\r\nfunction calculateLeft(style, curPositon, pointInfo) {\r\n  const { symmetricPoint, curPoint } = pointInfo;\r\n  const rotatedcurPositon = calculateRotatedPointCoordinate(\r\n    curPositon,\r\n    curPoint,\r\n    -style.rotate\r\n  );\r\n  const rotatedLeftMiddlePoint = calculateRotatedPointCoordinate(\r\n    {\r\n      x: rotatedcurPositon.x,\r\n      y: curPoint.y,\r\n    },\r\n    curPoint,\r\n    style.rotate\r\n  );\r\n\r\n  const newWidth = Math.sqrt(\r\n    (rotatedLeftMiddlePoint.x - symmetricPoint.x) ** 2 +\r\n      (rotatedLeftMiddlePoint.y - symmetricPoint.y) ** 2\r\n  );\r\n  if (newWidth > 0) {\r\n    const newCenter = {\r\n      x:\r\n        rotatedLeftMiddlePoint.x -\r\n        (rotatedLeftMiddlePoint.x - symmetricPoint.x) / 2,\r\n      y:\r\n        rotatedLeftMiddlePoint.y +\r\n        (symmetricPoint.y - rotatedLeftMiddlePoint.y) / 2,\r\n    };\r\n\r\n    style.width = Math.round(newWidth);\r\n    style.top = Math.round(newCenter.y - style.height / 2);\r\n    style.left = Math.round(newCenter.x - newWidth / 2);\r\n  }\r\n}\r\n\r\nfunction calculateRightTop(style, curPositon, pointInfo) {\r\n  const { symmetricPoint } = pointInfo;\r\n  const newCenterPoint = getCenterPoint(curPositon, symmetricPoint);\r\n  const newTopRightPoint = calculateRotatedPointCoordinate(\r\n    curPositon,\r\n    newCenterPoint,\r\n    -style.rotate\r\n  );\r\n  const newBottomLeftPoint = calculateRotatedPointCoordinate(\r\n    symmetricPoint,\r\n    newCenterPoint,\r\n    -style.rotate\r\n  );\r\n\r\n  const newWidth = newTopRightPoint.x - newBottomLeftPoint.x;\r\n  const newHeight = newBottomLeftPoint.y - newTopRightPoint.y;\r\n  if (newWidth > 0 && newHeight > 0) {\r\n    style.width = Math.round(newWidth);\r\n    style.height = Math.round(newHeight);\r\n    style.left = Math.round(newBottomLeftPoint.x);\r\n    style.top = Math.round(newTopRightPoint.y);\r\n  }\r\n}\r\n\r\nfunction calculateRightBottom(style, curPositon, pointInfo) {\r\n  const { symmetricPoint } = pointInfo;\r\n  const newCenterPoint = getCenterPoint(curPositon, symmetricPoint);\r\n  const newTopLeftPoint = calculateRotatedPointCoordinate(\r\n    symmetricPoint,\r\n    newCenterPoint,\r\n    -style.rotate\r\n  );\r\n  const newBottomRightPoint = calculateRotatedPointCoordinate(\r\n    curPositon,\r\n    newCenterPoint,\r\n    -style.rotate\r\n  );\r\n\r\n  const newWidth = newBottomRightPoint.x - newTopLeftPoint.x;\r\n  const newHeight = newBottomRightPoint.y - newTopLeftPoint.y;\r\n  if (newWidth > 0 && newHeight > 0) {\r\n    style.width = Math.round(newWidth);\r\n    style.height = Math.round(newHeight);\r\n    style.left = Math.round(newTopLeftPoint.x);\r\n    style.top = Math.round(newTopLeftPoint.y);\r\n  }\r\n}\r\n\r\nfunction calculateLeftBottom(style, curPositon, pointInfo) {\r\n  const { symmetricPoint } = pointInfo;\r\n  const newCenterPoint = getCenterPoint(curPositon, symmetricPoint);\r\n  const newTopRightPoint = calculateRotatedPointCoordinate(\r\n    symmetricPoint,\r\n    newCenterPoint,\r\n    -style.rotate\r\n  );\r\n  const newBottomLeftPoint = calculateRotatedPointCoordinate(\r\n    curPositon,\r\n    newCenterPoint,\r\n    -style.rotate\r\n  );\r\n\r\n  const newWidth = newTopRightPoint.x - newBottomLeftPoint.x;\r\n  const newHeight = newBottomLeftPoint.y - newTopRightPoint.y;\r\n  if (newWidth > 0 && newHeight > 0) {\r\n    style.width = Math.round(newWidth);\r\n    style.height = Math.round(newHeight);\r\n    style.left = Math.round(newBottomLeftPoint.x);\r\n    style.top = Math.round(newTopRightPoint.y);\r\n  }\r\n}\r\n\r\nexport default function calculateComponentPositonAndSize(\r\n  name,\r\n  style,\r\n  curPositon,\r\n  pointInfo\r\n) {\r\n  funcs[name](style, curPositon, pointInfo);\r\n}\r\n","import { stringify } from '@angular/compiler/src/util';\nimport { Component, Input, OnInit, ViewEncapsulation } from '@angular/core';\nimport { ComponentDataService } from '../../../core/component/component-data.service';\nimport {\n  ComponentBaseStyle,\n  ComponentBaseData,\n} from '../../../types/component-type';\nimport calculateComponentPositonAndSize from '../../../utils/calculateComponentPositonAndSize';\n\n@Component({\n  selector: 'shape',\n  templateUrl: './shape.component.html',\n  styleUrls: ['./shape.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n})\nexport class ShapeComponent implements OnInit {\n  @Input() active: boolean = false;\n  @Input() element: ComponentBaseData;\n  @Input() defaultStyle: ComponentBaseStyle;\n  @Input() index: number;\n  cursors = {};\n  pointList: string[] = ['lt', 't', 'rt', 'r', 'rb', 'b', 'lb', 'l']; // å«ä¸ªæ¹å\n  initialAngle = {\n    // æ¯ä¸ªç¹å¯¹åºçåå§è§åº¦\n    lt: 0,\n    t: 45,\n    rt: 90,\n    r: 135,\n    rb: 180,\n    b: 225,\n    lb: 270,\n    l: 315,\n  };\n  angleToCursor = [\n    // æ¯ä¸ªèå´çè§åº¦å¯¹åºçåæ \n    { start: 338, end: 23, cursor: 'nw' },\n    { start: 23, end: 68, cursor: 'n' },\n    { start: 68, end: 113, cursor: 'ne' },\n    { start: 113, end: 158, cursor: 'e' },\n    { start: 158, end: 203, cursor: 'se' },\n    { start: 203, end: 248, cursor: 's' },\n    { start: 248, end: 293, cursor: 'sw' },\n    { start: 293, end: 338, cursor: 'w' },\n  ];\n  constructor(public componentDataService: ComponentDataService) {}\n\n  ngOnInit(): void {}\n\n  getShapeStyle(style: ComponentBaseStyle) {\n    const result = { ...style };\n    if (result.width) {\n      result.width += 'px';\n    }\n\n    if (result.height) {\n      result.height += 'px';\n    }\n\n    if (result.top) {\n      result.top += 'px';\n    }\n\n    if (result.left) {\n      result.left += 'px';\n    }\n\n    if (result.rotate) {\n      result['transform'] = 'rotate(' + result.rotate + 'deg)';\n    }\n\n    return result;\n  }\n\n  handleMouseDownOnShape(e) {\n    if (this.element.component != 'v-text') {\n      e.preventDefault();\n    }\n\n    e.stopPropagation();\n    this.componentDataService.curComponent = this.element;\n    this.componentDataService.curComponentIndex = this.index;\n    this.cursors = this.getCursor(); // æ ¹æ®æè½¬è§åº¦è·ååæ ä½ç½®\n    const pos = { ...this.defaultStyle };\n    const startY = e.clientY;\n    const startX = e.clientX;\n    // å¦æç´æ¥ä¿®æ¹å±æ§ï¼å¼çç±»åä¼åä¸ºå­ç¬¦ä¸²ï¼æä»¥è¦è½¬ä¸ºæ°å¼å\n    const startTop = Number(pos.top);\n    const startLeft = Number(pos.left);\n\n    // å¦æåç´ æ²¡æç§»å¨ï¼åä¸ä¿å­å¿«ç§\n    let hasMove = false;\n    const move = (moveEvent) => {\n      hasMove = true;\n      const curX = moveEvent.clientX;\n      const curY = moveEvent.clientY;\n      pos.top = curY - startY + startTop;\n      pos.left = curX - startX + startLeft;\n\n      // ä¿®æ¹å½åç»ä»¶æ ·å¼\n      this.componentDataService.$shapeStyle.next(pos);\n      // ç­æ´æ°å®å½åç»ä»¶çæ ·å¼å¹¶ç»å¶å°å±å¹ååå¤æ­æ¯å¦éè¦å¸é\n      // å¦æä¸ä½¿ç¨ $nextTickï¼å¸éåå°æ æ³ç§»å¨\n      // this.$nextTick(() => {\n      //   // è§¦ååç´ ç§»å¨äºä»¶ï¼ç¨äºæ¾ç¤ºæ çº¿ãå¸éåè½\n      //   // åé¢ä¸¤ä¸ªåæ°ä»£è¡¨é¼ æ ç§»å¨æ¹å\n      //   // curY - startY > 0 true è¡¨ç¤ºåä¸ç§»å¨ false è¡¨ç¤ºåä¸ç§»å¨\n      //   // curX - startX > 0 true è¡¨ç¤ºåå³ç§»å¨ false è¡¨ç¤ºåå·¦ç§»å¨\n      //   eventBus.$emit('move', curY - startY > 0, curX - startX > 0);\n      // })\n      this.componentDataService.notification.next({\n        event: 'move',\n        value: [curY - startY > 0, curX - startX > 0],\n      });\n    };\n\n    const up = () => {\n      hasMove && this.componentDataService.recordSnapshot();\n      // è§¦ååç´ åæ­¢ç§»å¨äºä»¶ï¼ç¨äºéèæ çº¿\n      // eventBus.$emit('unmove')\n      this.componentDataService.notification.next({\n        event: 'unmove',\n      });\n      document.removeEventListener('mousemove', move);\n      document.removeEventListener('mouseup', up);\n    };\n\n    document.addEventListener('mousemove', move);\n    document.addEventListener('mouseup', up);\n  }\n\n  selectCurComponent(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    this.componentDataService.hideContextMenu();\n  }\n\n  handleRotate() {}\n\n  handleMouseDownOnPoint(point: string, e) {\n    const downEvent = window.event;\n    downEvent.stopPropagation();\n    downEvent.preventDefault();\n\n    const style = { ...this.defaultStyle };\n    const center = {\n      x: style.left + style.width / 2,\n      y: style.top + style.height / 2,\n    };\n\n    // è·åç»å¸ä½ç§»ä¿¡æ¯\n    const editorRectInfo = document\n      .querySelector('#editor')\n      .getBoundingClientRect();\n\n    // å½åç¹å»åæ \n    const curPoint = {\n      x: e.clientX - editorRectInfo.left,\n      y: e.clientY - editorRectInfo.top,\n    };\n\n    // è·åå¯¹ç§°ç¹çåæ \n    const symmetricPoint = {\n      x: center.x - (curPoint.x - center.x),\n      y: center.y - (curPoint.y - center.y),\n    };\n\n    // æ¯å¦éè¦ä¿å­å¿«ç§\n    let needSave = false;\n    let isFirst = true;\n    const move = (moveEvent) => {\n      // ç¬¬ä¸æ¬¡ç¹å»æ¶ä¹ä¼è§¦å moveï¼æä»¥ä¼æâåç¹å»ç»ä»¶ä½æªç§»å¨ï¼ç»ä»¶çå¤§å°å´æ¹åäºâçæåµåç\n      // å æ­¤ç¬¬ä¸æ¬¡ç¹å»æ¶ä¸è§¦å move äºä»¶\n      if (isFirst) {\n        isFirst = false;\n        return;\n      }\n\n      needSave = true;\n      const curPositon = {\n        x: moveEvent.clientX - editorRectInfo.left,\n        y: moveEvent.clientY - editorRectInfo.top,\n      };\n\n      calculateComponentPositonAndSize(point, style, curPositon, {\n        center,\n        curPoint,\n        symmetricPoint,\n      });\n\n      this.componentDataService.$shapeStyle.next(style);\n    };\n\n    const up = () => {\n      document.removeEventListener('mousemove', move);\n      document.removeEventListener('mouseup', up);\n      needSave && this.componentDataService.recordSnapshot();\n    };\n\n    document.addEventListener('mousemove', move);\n    document.addEventListener('mouseup', up);\n  }\n\n  getPointStyle(\n    point: string\n  ): {\n    marginLeft: string;\n    marginTop: string;\n    left: string;\n    top: string;\n    cursor: string;\n  } {\n    const { width, height } = this.defaultStyle;\n    const hasT = /t/.test(point);\n    const hasB = /b/.test(point);\n    const hasL = /l/.test(point);\n    const hasR = /r/.test(point);\n    let newLeft = 0;\n    let newTop = 0;\n\n    // åä¸ªè§çç¹\n    if (point.length === 2) {\n      newLeft = hasL ? 0 : width;\n      newTop = hasT ? 0 : height;\n    } else {\n      // ä¸ä¸ä¸¤ç¹çç¹ï¼å®½åº¦å±ä¸­\n      if (hasT || hasB) {\n        newLeft = width / 2;\n        newTop = hasT ? 0 : height;\n      }\n\n      // å·¦å³ä¸¤è¾¹çç¹ï¼é«åº¦å±ä¸­\n      if (hasL || hasR) {\n        newLeft = hasL ? 0 : width;\n        newTop = Math.floor(height / 2);\n      }\n    }\n\n    const style = {\n      marginLeft: hasR ? '-4px' : '-4px',\n      marginTop: '-4px',\n      left: `${newLeft}px`,\n      top: `${newTop}px`,\n      cursor: this.cursors[point],\n    };\n\n    return style;\n  }\n\n  getCursor() {\n    const { angleToCursor, initialAngle, pointList } = this;\n    const curComponent = this.componentDataService.curComponent;\n    const rotate = (curComponent.style.rotate + 360) % 360; // é²æ­¢è§åº¦æè´æ°ï¼æä»¥ + 360\n    const result = {};\n    let lastMatchIndex = -1; // ä»ä¸ä¸ä¸ªå½ä¸­çè§åº¦çç´¢å¼å¼å§å¹éä¸ä¸ä¸ªï¼éä½æ¶é´å¤æåº¦\n    pointList.forEach((point) => {\n      const angle = (initialAngle[point] + rotate) % 360;\n      const len = angleToCursor.length;\n      while (true) {\n        lastMatchIndex = (lastMatchIndex + 1) % len;\n        const angleLimit = angleToCursor[lastMatchIndex];\n        if (angle < 23 || angle >= 338) {\n          result[point] = 'nw-resize';\n          return;\n        }\n\n        if (angleLimit.start <= angle && angle < angleLimit.end) {\n          result[point] = angleLimit.cursor + '-resize';\n          return;\n        }\n      }\n    });\n\n    return result;\n  }\n}\n","import { Component, Input, OnInit, ViewEncapsulation } from '@angular/core';\n\n@Component({\n  selector: 'v-button',\n  template: `\n    <button class=\"v-button\" [ngStyle]=\"vStyle\" [class.absoulte]=\"absoulte\">\n      {{ propValue }}\n    </button>\n  `,\n  styleUrls: ['./v-button.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n})\nexport class VButtonComponent implements OnInit {\n  @Input() propValue: string = '';\n  @Input() vStyle = {};\n  @Input() absoulte: boolean = false;\n  constructor() {}\n\n  ngOnInit(): void {}\n}\n","import { Component, OnInit, ViewEncapsulation } from '@angular/core';\nimport { ComponentDataService } from '../../../core/component/component-data.service';\nimport { deepCopy } from '../../../utils/utils';\n\n@Component({\n  selector: 'context-menu',\n  templateUrl: './context-menu.component.html',\n  styleUrls: ['./context-menu.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n})\nexport class ContextMenuComponent implements OnInit {\n  get menuShow(): boolean {\n    return this.componentDataService.contextmenu.show;\n  }\n  get menuTop(): number {\n    return this.componentDataService.contextmenu.top;\n  }\n  get menuLeft(): number {\n    return this.componentDataService.contextmenu.left;\n  }\n  constructor(public componentDataService: ComponentDataService) {}\n\n  ngOnInit(): void {}\n\n  copy() {\n    this.componentDataService.copy();\n  }\n\n  paste() {\n    this.componentDataService.paste(true);\n  }\n\n  cut() {\n    this.componentDataService.cut();\n  }\n\n  deleteComponent() {\n    this.componentDataService.deleteCurComponent();\n    this.componentDataService.recordSnapshot();\n  }\n\n  topComponent() {\n    this.componentDataService.topComponent();\n    this.componentDataService.recordSnapshot();\n  }\n\n  bottomComponent() {\n    this.componentDataService.bottomComponent();\n    this.componentDataService.recordSnapshot();\n  }\n\n  upComponent() {\n    this.componentDataService.upComponent();\n    this.componentDataService.recordSnapshot();\n  }\n\n  downComponent() {\n    this.componentDataService.downComponent();\n    this.componentDataService.recordSnapshot();\n  }\n}\n","import {\n  AfterContentInit,\n  Component,\n  ElementRef,\n  OnInit,\n  QueryList,\n  ViewChildren,\n  ViewEncapsulation,\n} from '@angular/core';\nimport { ComponentDataService } from '../../../core/component/component-data.service';\nimport { cos, sin } from '../../../utils/translate';\n\n@Component({\n  selector: 'Markline',\n  templateUrl: './markline.component.html',\n  styleUrls: ['./markline.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n})\nexport class MarklineComponent implements OnInit, AfterContentInit {\n  lines = ['xt', 'xc', 'xb', 'yl', 'yc', 'yr']; // åå«å¯¹åºä¸æ¡æ¨ªçº¿åä¸æ¡ç«çº¿\n  diff = 3; // ç¸è· dff åç´ å°èªå¨å¸é\n  lineStatus = {\n    xt: false,\n    xc: false,\n    xb: false,\n    yl: false,\n    yc: false,\n    yr: false,\n  };\n  @ViewChildren('lines') $refs: QueryList<any>;\n  constructor(public componentDataService: ComponentDataService) {}\n\n  ngAfterContentInit(): void {}\n\n  ngOnInit(): void {\n    this.componentDataService.notification.subscribe((x) => {\n      if (x.event === 'move') {\n        this.showLine(x.value[0], x.value[1]);\n      }\n      if (x.event === 'unmove') {\n        this.hideLine();\n      }\n    });\n  }\n\n  showLine(isDownward, isRightward) {\n    const lines = Array.from(document.querySelectorAll('.line'));\n    const findnode = (type) => {\n      return lines.find((x) => x['dataset'].index === type);\n    };\n    const components = this.componentDataService.componentData;\n    const curComponentStyle = this.translateComponentStyle(\n      this.componentDataService.curComponent.style\n    );\n    const curComponentHalfwidth = curComponentStyle.width / 2;\n    const curComponentHalfHeight = curComponentStyle.height / 2;\n    this.hideLine();\n    components.forEach((component) => {\n      if (component == this.componentDataService.curComponent) return;\n      const componentStyle = this.translateComponentStyle(component.style);\n      const { top, left, bottom, right } = componentStyle;\n      const componentHalfwidth = componentStyle.width / 2;\n      const componentHalfHeight = componentStyle.height / 2;\n      const conditions = {\n        top: [\n          {\n            isNearly: this.isNearly(curComponentStyle.top, top),\n            lineNode: findnode('xt'), // xt\n            line: 'xt',\n            dragShift: top,\n            lineShift: top,\n          },\n          {\n            isNearly: this.isNearly(curComponentStyle.bottom, top),\n            lineNode: findnode('xt'), // xt\n            line: 'xt',\n            dragShift: top - curComponentStyle.height,\n            lineShift: top,\n          },\n          {\n            // ç»ä»¶ä¸ææ½èç¹çä¸­é´æ¯å¦å¯¹é½\n            isNearly: this.isNearly(\n              curComponentStyle.top + curComponentHalfHeight,\n              top + componentHalfHeight\n            ),\n            lineNode: findnode('xc'), // xc\n            line: 'xc',\n            dragShift: top + componentHalfHeight - curComponentHalfHeight,\n            lineShift: top + componentHalfHeight,\n          },\n          {\n            isNearly: this.isNearly(curComponentStyle.top, bottom),\n            lineNode: findnode('xb'), // xb\n            line: 'xb',\n            dragShift: bottom,\n            lineShift: bottom,\n          },\n          {\n            isNearly: this.isNearly(curComponentStyle.bottom, bottom),\n            lineNode: findnode('xb'), // xb\n            line: 'xb',\n            dragShift: bottom - curComponentStyle.height,\n            lineShift: bottom,\n          },\n        ],\n        left: [\n          {\n            isNearly: this.isNearly(curComponentStyle.left, left),\n            lineNode: findnode('yl'), // yl\n            line: 'yl',\n            dragShift: left,\n            lineShift: left,\n          },\n          {\n            isNearly: this.isNearly(curComponentStyle.right, left),\n            lineNode: findnode('yl'), // yl\n            line: 'yl',\n            dragShift: left - curComponentStyle.width,\n            lineShift: left,\n          },\n          {\n            // ç»ä»¶ä¸ææ½èç¹çä¸­é´æ¯å¦å¯¹é½\n            isNearly: this.isNearly(\n              curComponentStyle.left + curComponentHalfwidth,\n              left + componentHalfwidth\n            ),\n            lineNode: findnode('yc'), // yc\n            line: 'yc',\n            dragShift: left + componentHalfwidth - curComponentHalfwidth,\n            lineShift: left + componentHalfwidth,\n          },\n          {\n            isNearly: this.isNearly(curComponentStyle.left, right),\n            lineNode: findnode('yr'), // yr\n            line: 'yr',\n            dragShift: right,\n            lineShift: right,\n          },\n          {\n            isNearly: this.isNearly(curComponentStyle.right, right),\n            lineNode: findnode('yr'), // yr\n            line: 'yr',\n            dragShift: right - curComponentStyle.width,\n            lineShift: right,\n          },\n        ],\n      };\n      const needToShow = [];\n      const { rotate } = this.componentDataService.curComponent.style;\n      Object.keys(conditions).forEach((key) => {\n        // éåç¬¦åçæ¡ä»¶å¹¶å¤ç\n        conditions[key].forEach((condition) => {\n          if (!condition.isNearly) return;\n          // ä¿®æ¹å½åç»ä»¶ä½ç§»\n          this.componentDataService.setShapePosStyle({\n            key,\n            value:\n              rotate != 0\n                ? this.translatecurComponentShift(\n                    key,\n                    condition,\n                    curComponentStyle\n                  )\n                : condition.dragShift,\n          });\n\n          condition.lineNode.style[key] = `${condition.lineShift}px`;\n          needToShow.push(condition.line);\n        });\n      });\n\n      // åä¸æ¹åä¸åæ¶æ¾ç¤ºä¸æ¡çº¿å¯è½ä¸å¤ªç¾è§ï¼å æ­¤ææäºè¿ä¸ªè§£å³æ¹æ¡\n      // åä¸æ¹åä¸ççº¿åªæ¾ç¤ºä¸æ¡ï¼ä¾å¦å¤æ¡æ¨ªæ¡åªæ¾ç¤ºä¸æ¡æ¨ªçº¿\n      if (needToShow.length) {\n        this.chooseTheTureLine(needToShow, isDownward, isRightward);\n      }\n    });\n  }\n\n  translateComponentStyle(style) {\n    style = { ...style };\n    if (style.rotate != 0) {\n      const newWidth =\n        style.width * cos(style.rotate) + style.height * sin(style.rotate);\n      const diffX = (style.width - newWidth) / 2;\n      style.left += diffX;\n      style.right = style.left + newWidth;\n\n      const newHeight =\n        style.height * cos(style.rotate) + style.width * sin(style.rotate);\n      const diffY = (newHeight - style.height) / 2;\n      style.top -= diffY;\n      style.bottom = style.top + newHeight;\n\n      style.width = newWidth;\n      style.height = newHeight;\n    } else {\n      style.bottom = style.top + style.height;\n      style.right = style.left + style.width;\n    }\n\n    return style;\n  }\n\n  hideLine() {\n    Object.keys(this.lineStatus).forEach((line) => {\n      this.lineStatus[line] = false;\n    });\n  }\n\n  isNearly(dragValue, targetValue) {\n    return Math.abs(dragValue - targetValue) <= this.diff;\n  }\n\n  translatecurComponentShift(key, condition, curComponentStyle) {\n    const { width, height } = this.componentDataService.curComponent.style;\n    if (key == 'top') {\n      return Math.round(\n        condition.dragShift - (height - curComponentStyle.height) / 2\n      );\n    }\n\n    return Math.round(\n      condition.dragShift - (width - curComponentStyle.width) / 2\n    );\n  }\n\n  chooseTheTureLine(needToShow, isDownward, isRightward) {\n    // å¦æé¼ æ åå³ç§»å¨ åæä»å³å°å·¦çé¡ºåºæ¾ç¤ºç«çº¿ å¦åæç¸åé¡ºåºæ¾ç¤º\n    // å¦æé¼ æ åä¸ç§»å¨ åæä»ä¸å°ä¸çé¡ºåºæ¾ç¤ºæ¨ªçº¿ å¦åæç¸åé¡ºåºæ¾ç¤º\n    if (isRightward) {\n      if (needToShow.includes('yr')) {\n        this.lineStatus.yr = true;\n      } else if (needToShow.includes('yc')) {\n        this.lineStatus.yc = true;\n      } else if (needToShow.includes('yl')) {\n        this.lineStatus.yl = true;\n      }\n    } else {\n      // eslint-disable-next-line no-lonely-if\n      if (needToShow.includes('yl')) {\n        this.lineStatus.yl = true;\n      } else if (needToShow.includes('yc')) {\n        this.lineStatus.yc = true;\n      } else if (needToShow.includes('yr')) {\n        this.lineStatus.yr = true;\n      }\n    }\n\n    if (isDownward) {\n      if (needToShow.includes('xb')) {\n        this.lineStatus.xb = true;\n      } else if (needToShow.includes('xc')) {\n        this.lineStatus.xc = true;\n      } else if (needToShow.includes('xt')) {\n        this.lineStatus.xt = true;\n      }\n    } else {\n      // eslint-disable-next-line no-lonely-if\n      if (needToShow.includes('xt')) {\n        this.lineStatus.xt = true;\n      } else if (needToShow.includes('xc')) {\n        this.lineStatus.xc = true;\n      } else if (needToShow.includes('xb')) {\n        this.lineStatus.xb = true;\n      }\n    }\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { ComponentDataService } from '../../core/component/component-data.service';\n\n@Component({\n  selector: 'Attr-list',\n  templateUrl: './attr-list.component.html',\n  styleUrls: ['./attr-list.component.scss'],\n})\nexport class AttrListComponent implements OnInit {\n  map = {\n    left: 'x åæ ',\n    top: 'y åæ ',\n    height: 'é«',\n    width: 'å®½',\n    color: 'é¢è²',\n    backgroundColor: 'èæ¯è²',\n    borderWidth: 'è¾¹æ¡å®½åº¦',\n    borderColor: 'è¾¹æ¡é¢è²',\n    borderRadius: 'è¾¹æ¡åå¾',\n    fontSize: 'å­ä½å¤§å°',\n    fontWeight: 'å­ä½ç²ç»',\n    lineHeight: 'è¡é«',\n    letterSpacing: 'å­é´è·',\n    textAlign: 'å¯¹é½æ¹å¼',\n    opacity: 'éæåº¦',\n  };\n  excludes = ['Picture']; // è¿äºç»ä»¶ä¸æ¾ç¤ºåå®¹\n  options = [\n    {\n      label: 'å·¦å¯¹é½',\n      value: 'left',\n    },\n    {\n      label: 'å±ä¸­',\n      value: 'center',\n    },\n    {\n      label: 'å³å¯¹é½',\n      value: 'right',\n    },\n  ];\n\n  get styleKeys(): string[] {\n    return this.componentDataService.curComponent\n      ? Object.keys(this.componentDataService.curComponent.style).filter(\n          (item) => item != 'rotate'\n        )\n      : [];\n  }\n  constructor(public componentDataService: ComponentDataService) {}\n\n  ngOnInit(): void {}\n}\n","import {\n  Component,\n  EventEmitter,\n  Input,\n  OnInit,\n  Output,\n  ViewEncapsulation,\n} from '@angular/core';\nimport { ComponentDataService } from '../../../core/component/component-data.service';\n\n@Component({\n  selector: 'Preview',\n  templateUrl: './preview.component.html',\n  styleUrls: ['./preview.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n})\nexport class PreviewComponent implements OnInit {\n  @Input() isShowPreview: boolean = false;\n  @Output() OutClose = new EventEmitter();\n  constructor(public componentDataService: ComponentDataService) {}\n\n  ngOnInit(): void {}\n\n  close() {\n    this.OutClose.emit();\n  }\n}\n","import {\n  Component,\n  ComponentFactoryResolver,\n  Input,\n  OnChanges,\n  OnInit,\n  SimpleChanges,\n  ViewChild,\n  ViewContainerRef,\n  ViewEncapsulation,\n} from '@angular/core';\nimport {\n  ComponentBaseData,\n  ComponentBaseStyle,\n  ComponentBasicInput,\n} from '../../../types/component-type';\nimport getStyle from '../../../utils/style';\nimport { VButtonComponent } from '../../custom-component/v-button/v-button.component';\n\n@Component({\n  selector: 'Component-wrapper',\n  templateUrl: './component-wrapper.component.html',\n  styleUrls: ['./component-wrapper.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n})\nexport class ComponentWrapperComponent implements OnInit, OnChanges {\n  @Input() config: ComponentBaseData;\n  @ViewChild('viewContainer', { read: ViewContainerRef, static: true })\n  viewContainer: ViewContainerRef;\n  constructor(private componentFactoryResolver: ComponentFactoryResolver) {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.config && changes.config.currentValue) {\n      // this.addComponent();\n    }\n  }\n\n  addComponent() {\n    // let cinstance;\n    // switch (this.config.component) {\n    //   case 'v-button':\n    //     cinstance = VButtonComponent;\n    //     break;\n    //   default:\n    //     break;\n    // }\n    // const componentFactory = this.componentFactoryResolver.resolveComponentFactory(\n    //   cinstance\n    // );\n    // const viewContainerRef = this.viewContainer;\n    // const componentRef = viewContainerRef.createComponent(componentFactory);\n    // (<ComponentBasicInput>(\n    //   componentRef.instance\n    // )).propValue = this.config.propValue;\n    // (<ComponentBasicInput>componentRef.instance).vStyle = this.config.style;\n    // debugger;\n  }\n\n  ngOnInit(): void {}\n\n  handleClick() {}\n\n  getComponentStyle(style: ComponentBaseStyle) {\n    return getStyle(style);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { NgxVisualDragComponent } from './ngx-visual-drag.component';\nimport { HomeComponent } from './pages/home/home.component';\nimport { ToolbarComponent } from './pages/toolbar/toolbar.component';\nimport { SharedModule } from './shared/shared/shared.module';\nimport { ComponentListComponent } from './pages/component-list/component-list.component';\nimport { EditorComponent } from './pages/editor/editor.component';\nimport { ShapeComponent } from './pages/editor/shape/shape.component';\nimport { VButtonComponent } from './pages/custom-component/v-button/v-button.component';\nimport { ContextMenuComponent } from './pages/editor/context-menu/context-menu.component';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\nimport { MarklineComponent } from './pages/editor/markline/markline.component';\nimport { AttrListComponent } from './pages/attr-list/attr-list.component';\nimport { PreviewComponent } from './pages/editor/preview/preview.component';\nimport { ComponentWrapperComponent } from './pages/editor/component-wrapper/component-wrapper.component';\n\n@NgModule({\n  declarations: [\n    NgxVisualDragComponent,\n    HomeComponent,\n    ToolbarComponent,\n    ComponentListComponent,\n    EditorComponent,\n    ShapeComponent,\n    VButtonComponent,\n    ContextMenuComponent,\n    MarklineComponent,\n    AttrListComponent,\n    PreviewComponent,\n    ComponentWrapperComponent,\n  ],\n  imports: [BrowserAnimationsModule, SharedModule],\n  exports: [NgxVisualDragComponent],\n})\nexport class NgxVisualDragModule {}\n"]}